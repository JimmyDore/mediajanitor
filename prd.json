{
  "project": "Media Janitor",
  "branchName": "ralph/ux-improvements-and-backlog",
  "userStories": [
    {
      "id": "US-12.1",
      "title": "Add Threshold Help Text",
      "story": "As a user, I want to understand what each threshold setting does, so that I can configure them correctly",
      "acceptanceCriteria": [
        "\"Flag content unwatched for\" shows help text: \"Used by: Old tab\"",
        "\"Don't flag content newer than\" shows help text: \"Used by: Old tab (for never-watched items)\"",
        "\"Flag movies larger than\" shows help text: \"Used by: Large tab\"",
        "Help text appears in subtle gray below each input",
        "Typecheck passes",
        "Unit tests pass",
        "Verify in browser using browser tools"
      ],
      "priority": 1,
      "passes": false,
      "notes": "File: frontend/src/routes/settings/+page.svelte"
    },
    {
      "id": "US-12.2",
      "title": "Remove Multi-Issue Tab",
      "story": "As a user, I want a simpler Issues page, so that I'm not confused by extra filters",
      "acceptanceCriteria": [
        "Multi-Issue tab removed from Issues page filter tabs",
        "URL parameter ?filter=multi no longer supported (returns all issues or 400)",
        "Backend API documentation updated to remove 'multi' filter option",
        "Typecheck passes",
        "Unit tests pass",
        "Verify in browser: only 5 tabs remain (All, Old, Large, Language, Requests)"
      ],
      "priority": 2,
      "passes": false,
      "notes": "Files: frontend/src/routes/issues/+page.svelte, backend/app/routers/content.py, backend/app/services/content.py"
    },
    {
      "id": "US-12.3",
      "title": "Fix TMDB Link Media Type",
      "story": "As a user, I want TMDB links to work correctly, so that I can check content details on TMDB",
      "acceptanceCriteria": [
        "TMDB links work for Movies (link to /movie/{id})",
        "TMDB links work for TV Shows (link to /tv/{id})",
        "Handle both uppercase (\"Movie\", \"Series\") and lowercase (\"movie\", \"tv\") media types",
        "Typecheck passes",
        "Unit tests pass",
        "Verify in browser: click TMDB link on Requests tab -> correct page opens"
      ],
      "priority": 3,
      "passes": false,
      "notes": "Root cause: getTmdbUrl() checks item.media_type === 'Movie' but request items use lowercase 'movie'. File: frontend/src/routes/issues/+page.svelte"
    },
    {
      "id": "US-12.5",
      "title": "External Links for All Issue Types",
      "story": "As a user, I want TMDB/IMDb links on all content items, so that I can easily look up any flagged content",
      "acceptanceCriteria": [
        "Old tab items show TMDB/IMDb links (where data exists)",
        "Large tab items show TMDB/IMDb links (where data exists)",
        "Language tab items show TMDB/IMDb links (where data exists)",
        "Requests tab items show TMDB/IMDb links (already implemented, just needs fix from US-12.3)",
        "External link icon appears next to title if TMDB or IMDb ID available",
        "Typecheck passes",
        "Unit tests pass",
        "Verify in browser: external links appear on items in all tabs"
      ],
      "priority": 4,
      "passes": false,
      "notes": "Backend already extracts TMDB/IMDb IDs via extract_provider_ids(). File: frontend/src/routes/issues/+page.svelte"
    },
    {
      "id": "US-15.1",
      "title": "Fix Hidden Requests Showing TMDB IDs",
      "story": "As a user, I want hidden requests to show actual movie/show titles, so that I can identify what content I've hidden",
      "acceptanceCriteria": [
        "Hidden Requests tab shows actual titles, not \"TMDB-123456\"",
        "Backend looks up title from CachedJellyseerrRequest table when whitelisting",
        "Typecheck passes",
        "Unit tests pass",
        "Verify in browser using browser tools"
      ],
      "priority": 5,
      "passes": false,
      "notes": "Root Cause: Frontend passes item.name which may be the fallback TMDB-{id} string. Files: backend/app/routers/whitelist.py, backend/app/services/content.py"
    },
    {
      "id": "US-15.8",
      "title": "Fix Auth Check Loading Delay",
      "story": "As a user, I want public pages to load instantly, so that I don't see a loading spinner on landing/login/register pages",
      "acceptanceCriteria": [
        "Landing page (/) renders immediately without loading state",
        "Login page (/login) renders immediately without loading state",
        "Register page (/register) renders immediately without loading state",
        "Protected routes still show loading while auth check runs",
        "Typecheck passes",
        "Unit tests pass",
        "Verify in browser using browser tools"
      ],
      "priority": 6,
      "passes": false,
      "notes": "Root Cause: Layout shows loading for ALL routes. Should only show loading on protected routes. File: frontend/src/routes/+layout.svelte"
    },
    {
      "id": "US-15.9",
      "title": "Remove Unused api.ts File",
      "story": "As a developer, I want unused code removed, so that the codebase is clean and maintainable",
      "acceptanceCriteria": [
        "frontend/src/lib/api.ts file deleted",
        "No import errors after deletion",
        "Typecheck passes",
        "Unit tests pass"
      ],
      "priority": 7,
      "passes": false,
      "notes": "Unused exports: contentApi, languageApi, requestsApi, whitelistApi, settingsApi, healthApi. File: frontend/src/lib/api.ts"
    },
    {
      "id": "US-15.2",
      "title": "Add Radarr Connection Settings",
      "story": "As a user, I want to connect my Radarr instance, so that I can delete movies directly from the dashboard",
      "acceptanceCriteria": [
        "Settings page has Radarr section: URL + API Key",
        "Backend validates connection by calling GET /api/v3/system/status",
        "Credentials stored encrypted in database",
        "Toast notification on success/error",
        "Typecheck passes",
        "Unit tests pass",
        "Verify in browser using browser tools"
      ],
      "priority": 10,
      "passes": true,
      "notes": "API: X-Api-Key header, test endpoint: GET /api/v3/system/status. Files: backend/app/database.py, backend/app/routers/settings.py, backend/app/services/radarr.py, frontend/src/routes/settings/+page.svelte"
    },
    {
      "id": "US-15.3",
      "title": "Add Sonarr Connection Settings",
      "story": "As a user, I want to connect my Sonarr instance, so that I can delete TV series directly from the dashboard",
      "acceptanceCriteria": [
        "Settings page has Sonarr section: URL + API Key",
        "Backend validates connection by calling GET /api/v3/system/status",
        "Credentials stored encrypted in database",
        "Toast notification on success/error",
        "Typecheck passes",
        "Unit tests pass",
        "Verify in browser using browser tools"
      ],
      "priority": 11,
      "passes": true,
      "notes": "API: X-Api-Key header, test endpoint: GET /api/v3/system/status. Files: backend/app/database.py, backend/app/routers/settings.py, backend/app/services/sonarr.py, frontend/src/routes/settings/+page.svelte"
    },
    {
      "id": "US-15.4",
      "title": "Delete Movie from Radarr",
      "story": "As a user, I want to delete a movie via the dashboard, so that it's removed from Radarr and Jellyfin automatically",
      "acceptanceCriteria": [
        "Backend endpoint to delete movie by TMDB ID",
        "Finds Radarr movie ID via GET /api/v3/movie?tmdbId={id}",
        "Deletes via DELETE /api/v3/movie/{id}?deleteFiles=true",
        "Returns success/error response",
        "Deleting from Radarr with files auto-deletes from Jellyfin",
        "Typecheck passes",
        "Unit tests pass"
      ],
      "priority": 20,
      "passes": false,
      "notes": "Depends on US-15.2. Files: backend/app/services/radarr.py, backend/app/routers/content.py"
    },
    {
      "id": "US-15.5",
      "title": "Delete Series from Sonarr",
      "story": "As a user, I want to delete a TV series via the dashboard, so that it's removed from Sonarr and Jellyfin automatically",
      "acceptanceCriteria": [
        "Backend endpoint to delete series by TMDB ID",
        "Finds Sonarr series via GET /api/v3/series (iterate to find tmdbId match)",
        "Deletes via DELETE /api/v3/series/{id}?deleteFiles=true",
        "Returns success/error response",
        "Deleting from Sonarr with files auto-deletes from Jellyfin",
        "Typecheck passes",
        "Unit tests pass"
      ],
      "priority": 21,
      "passes": false,
      "notes": "Depends on US-15.3. Files: backend/app/services/sonarr.py, backend/app/routers/content.py"
    },
    {
      "id": "US-15.6",
      "title": "Delete Jellyseerr Request",
      "story": "As a user, I want to delete a request from Jellyseerr, so that it's removed from the requests list",
      "acceptanceCriteria": [
        "Backend endpoint to delete request by jellyseerr_id",
        "Calls DELETE /api/v1/request/{requestId} on Jellyseerr",
        "Returns success/error response (204 No Content on success)",
        "Typecheck passes",
        "Unit tests pass"
      ],
      "priority": 22,
      "passes": false,
      "notes": "API: X-Api-Key header, response: 204 No Content. Files: backend/app/services/jellyseerr.py, backend/app/routers/content.py"
    },
    {
      "id": "US-15.7",
      "title": "Delete Content UI",
      "story": "As a user, I want a delete button on content items, so that I can remove content without leaving the dashboard",
      "acceptanceCriteria": [
        "\"Delete\" button appears on content items in Issues view",
        "Button disabled/greyed if Radarr/Sonarr not configured",
        "Tooltip explains why disabled when not configured",
        "Confirmation modal with 2 checkboxes: Delete from Radarr/Sonarr (default checked), Delete from Jellyseerr (default checked)",
        "Loading state during deletion",
        "Toast notification on success/error",
        "Item removed from list after successful deletion",
        "For Movies: calls Radarr delete",
        "For Series: calls Sonarr delete",
        "If request exists: optionally deletes from Jellyseerr",
        "Typecheck passes",
        "Unit tests pass",
        "Verify in browser using browser tools"
      ],
      "priority": 30,
      "passes": false,
      "notes": "Depends on US-15.4, US-15.5, US-15.6. File: frontend/src/routes/issues/+page.svelte"
    }
  ]
}
