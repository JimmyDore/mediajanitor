# Plex Dashboard - Progress Log

## Completed Tasks

### 2026-01-12: US-0.1 - Hello World (Full Stack)
- Created project structure with FastAPI backend and SvelteKit frontend
- Implemented GET /api/hello endpoint (TDD: test first, then implementation)
- Frontend fetches and displays "Hello World" from backend
- Docker setup: Dockerfiles + docker-compose.yml
- Verified full stack communication with docker-compose up
- Commits:
  - feat(api): add hello world endpoint
  - feat(ui): display hello message from backend
  - chore(docker): add Docker setup for full stack

### 2026-01-12: US-0.3 - Deploy to VPS
- Configured DNS for mediajanitor.com (A record pointing to 194.32.76.43)
- Deployed app to VPS at ~/mediajanitor
- Configured nginx reverse proxy with SSL (certbot)
- Set up GitHub Actions CI/CD workflow
- Configured GitHub secrets (VPS_HOST, VPS_USERNAME, VPS_SSH_KEY)
- App accessible at https://mediajanitor.com
- Commits:
  - chore: add allowedHosts for production domain
  - chore: configure GitHub Actions for auto-deploy

### 2026-01-12: US-1.1 - User Registration
- Created User model with SQLAlchemy (email, hashed_password, timestamps)
- Implemented POST /api/auth/register endpoint with validation
- Password hashing using bcrypt
- Registration form at /register with email/password fields
- Client-side password validation (min 8 characters)
- Error handling for duplicate emails and validation errors
- Redirect to login page after successful registration
- Backend tests: 7 new tests for registration endpoint
- Frontend tests: 6 new tests for API integration and validation
- Migrated from passlib to bcrypt directly (compatibility fix)
- Converted project to use uv package manager
- Commits:
  - feat(auth): add user registration endpoint with password hashing
  - feat(ui): add registration form page

### 2026-01-12: US-1.2 - User Login
- Implemented POST /api/auth/login endpoint with JWT token generation
- Added python-jose[cryptography] for JWT support
- Added secret_key and access_token_expire_minutes settings
- Login validates credentials and returns JWT access_token with bearer type
- Created login form at /login with email/password fields
- Token stored in localStorage after successful login
- Redirect to dashboard after successful login
- Backend tests: 6 new tests for login endpoint
- Frontend tests: 4 new tests for login API integration
- E2E tests: 5 new tests for login page UI
- Verified in Docker: register + login flow works correctly
- Commits:
  - feat(auth): add user login endpoint with JWT

### 2026-01-12: US-1.3 - Protected Routes
- Implemented `get_current_user` dependency for JWT token validation
- Added `/api/auth/me` endpoint to return current user info
- Created OAuth2PasswordBearer scheme for token extraction
- Frontend auth store with checkAuth(), logout(), setUser() methods
- Layout redirects unauthenticated users to /login (public routes: /login, /register)
- Login page updates auth state and redirects to dashboard
- Dashboard shows user email and logout button when authenticated
- Backend tests: 6 new tests for protected endpoint scenarios
- E2E tests: 4 new tests for protected routes behavior
- Verified in Docker: full auth flow (register -> login -> /me -> logout)
- Commits:
  - feat(auth): add protected routes with JWT validation

### 2026-01-12: US-2.1 - Configure Jellyfin Connection
- Created UserSettings model in database.py with per-user encrypted credentials
- Implemented Fernet encryption for API keys (app/services/encryption.py)
- Created Jellyfin service (app/services/jellyfin.py) with:
  - validate_jellyfin_connection() - Tests connection to Jellyfin server
  - save_jellyfin_settings() - Saves encrypted credentials to DB
  - get_user_jellyfin_settings() - Retrieves user's settings
- Created settings router (app/routers/settings.py) with:
  - POST /api/settings/jellyfin - Save settings after validation
  - GET /api/settings/jellyfin - Get current settings (masked API key)
- Created settings page at /settings with:
  - Form for Jellyfin URL and API key
  - Status badge showing connection state
  - Success/error feedback messages
  - Back to dashboard link
- Added Settings link to dashboard page
- Backend tests: 9 new tests for settings endpoints
- E2E tests: 7 new tests for settings page UI
- Verified in Docker: API endpoints work correctly
- Commits:
  - feat(settings): add Jellyfin connection configuration

## Current Status

**Phase**: Epic 2 - Configuration (In Progress)
**Next US**: US-2.2 - Configure Jellyseerr Connection

## Notes

- US-0.2 (Dockerize) was completed together with US-0.1 since Docker setup was needed for testing
- Backend runs on port 8080 (mapped from 8000), Frontend on port 5173
- API proxy configured in vite.config.ts for dev environment
- Production: https://mediajanitor.com with HTTPS via Let's Encrypt
- CI/CD: Push to main triggers auto-deploy to VPS
